<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Winshuttle - Form Control</title>
        <link href="assets/css/kendo.common.min.css" rel="stylesheet">
        <link href="assets/css/kendo.default.min.css" rel="stylesheet">
        <link href="assets/css/kendo.dataviz.min.css" rel="stylesheet">
        <link href="assets/css/kendo.dataviz.default.min.css" rel="stylesheet">
        <link href="assets/css/winshuttle.css" rel="stylesheet">
        <link href="assets/css/ws-formitems.css" rel="stylesheet">
    </head>
    <body>
        <div id="workflow-header">
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span6">
                        <div class="workflow-brand">
                            <img src="assets/img/ws-logo-workflow.png" alt="Winshuttle"/>
                            <div class="home-dropdown">
                                <div class="btn-group">
                                    <a class="btn btn-action dropdown-toggle" data-toggle="dropdown" href="#"></a>
                                    <ul class="dropdown-menu">
                                        <div>
                                            <li class="dropdown-title">Logs &amp; Reporting</li>
                                            <li><a href="#">Charts</a></li>
                                            <li><a href="#">Excel Data Dump</a></li>
                                            <li><a href="#">Logging</a></li>
                                            <li><a href="#">Log File Viewer</a></li>
                                            <li class="dropdown-title">Processes</li>
                                            <li><a href="#">Process Control</a></li>
                                            <li><a href="#">Manage Background Jobs</a></li>
                                        </div>
                                        <div>
                                            <li class="dropdown-title">Server Administration</li>
                                            <li><a href="#">Admin Commands</a></li>
                                            <li><a href="#">Configure Options</a></li>
                                            <li><a href="#">Scheduler</a></li>
                                            <li><a href="#">Workflow Extensions</a></li>
                                            <li><a href="#">Database Status</a></li>
                                            <li><a href="#">Licenses</a></li>
                                        </div>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="span6">
                        <ul class="inline-list pull-right">
                            <!--
                                <li>
                                    <a class="font-white" href="javascript:;">&#9664; Winshuttle Central</a>
                                </li>
                                -->
                            <li>
                                <select class="input-medium" id="webappdropdown">
                                    
                                </select>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div id="mainsi">
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span12">
                        <ul id="breadcrumbs">
                            <li><a href="#">Administration</a> &rsaquo;</li>
                            <li><a href="#">Server Administration</a></li>
                            <li class="related-links">
                                <ul>
                                    <li class="related-label">Related Tasks:</li>
                                    <li class="link"><a href="#">Add Form Control</a></li>
                                    <li class="link"><a href="#">Extension Configuration</a></li>
                                    <li class="link"><a href="#">Plugins</a></li>
                                    <li class="link"><a href="#">Participant Resolver</a></li>
                                </ul>
                            </li>
                        </ul>
                        <ul id="secnav">
                            <li class="active">
                                <h1>Form Control</h1>
                                <p class="page-description">Page description goes here.  If no page description exists, delete this paragraph.  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row-fluid">
                    <table class="table table-header">
                        <tbody>
                            <tr>
                                <td>
                                    <form>
                                        <div>
                                            <label>Control name contains</label>
                                            <input type="text" id="txtNameControl" class="form-control input-large" placeholder="">
                                        </div>
                                        <div>
                                            <label>Control Definition contains</label>
                                            <input type="text" id="txtDefinitionControl" class="form-control input-large" placeholder="">
                                        </div>
                                        <div>
                                            <label>&nbsp;</label>
                                            <button class="btn btn-primary" id="btnSearch"><span>Search</span></button>
                                        </div>
                                    </form>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="row-fluid">
                    <div class="span12">
                        <table id="table-controls" class="table table-scheduler table-striped table-bordered">
                            <thead>
                                <tr class="table-menu">
                                    <th colspan="2">
                                        <div class="display">
                                            <span>Displaying 1 - 50 of 125 <a href="#">Export</a></span>
                                            <select name="" id="pagesizedropdown" onchange="" class="input-small">
                                                <option selected="selected" value="10">10</option>
                                                <option value="20">20</option>
                                                <option value="50">50</option>
                                                <option value="100">100</option>
                                                <option value="200">200</option>
                                                <option value="500">500</option>
                                            </select>
                                        </div>
                                    </th>
                                </tr>
                                <tr class="table-sort">
                                    <th><a href="#">Form Control Name</a></th>
                                    <th><a href="#">Form Control Definition</a></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="table-dropdown">
                                        <span>Lookup</span>
                                        <div class="btn-group">
                                            <a class="btn btn-action dropdown-toggle" data-toggle="dropdown" href="#"></a>
                                            <ul class="dropdown-menu">
                                                <li><a href="#">Edit</a></li>
                                                <li><a href="#">Delete</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td>&#60;xml code preview goes here&#62;</td>
                                </tr>                                
                            </tbody>
                        </table>
                        <ul class="pagination">
                            <li><a href="#" class="btn btn-disabled"><span>&larr;</span></a></li>
                            <li><a href="#" class="btn btn-primary"><span>1</span></a></li>
                            <li><a href="#" class="btn"><span>2</span></a></li>
                            <li><a href="#" class="btn"><span>3</span></a></li>
                            <li><a href="#" class="btn"><span>&rarr;</span></a></li>
                        </ul>
                    </div>
                    <!-- /div .span8 -->
                </div>
                <!-- /div .row-fluid -->
            </div>
            <!-- /div .container-fluid -->
        </div>
        <!-- /div #mainsi -->
        
        <div id="footer" class="row-fluid">
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span8">
                        <div id="footer-links">
                            <ul>
                                <li><a href="#">Home</a></li>
                                <li><a href="#">{{Back to Central}}</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="span4">
                        <div class="pull-right">
                            &copy; 2008-2015 Winshuttle, LLC
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script>
            if (!window.jQuery) {
                console.error("jQuery CDN is down.")
                document.write('<script src="assets/js/jquery.min.js"><\/script>');
            }
        </script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
        <script>
            if (!$.fn.modal) {
                console.error("Bootstrap CDN is down.")
                document.write('<script src="assets/js/bootstrap.min.js"><\/script>');
            }
        </script>
        <script src="assets/js/kendo.all.min.js"></script>
        <script src="assets/js/chosen.jquery.min.js"></script>
        <script src="assets/js/wslib_master.js"></script>
        <script src="assets/js/wsplugin_master.js"></script>
        <script src="assets/js/ws_common.js" type="text/javascript"></script>
        <script>
            var thePageCount;
            var theRecordCount;
            var thePagenumber = 1;
            $('a.js-tooltip-target').tooltip({
                html: true,
                trigger: 'click',
                animation: true
            });
            
            $('body').on('click', '.js-tooltip-target', function(event) {
                event.stopPropagation();
                
                $('div.tooltip').not($(this).siblings('div.tooltip')).remove();
            });
            
            $(document).ready(function () {
                ws_initializeWebApp("/admin/GetAllWebApp", $('#webappdropdown'), OnLoad);
                $("#btnSearch").click(function () {
                    LoadData(thePagenumber);
                    return false;
                });

                $('#webappdropdown, #pagesizedropdown').change(function () {
                    thePagenumber = 1;
                    OnLoad();
                    return false;
                });
            });

            function OnLoad() {
                $("#txtNameControl").val("");
                $("#txtDefinitionControl").val("");
                thePagenumber = 1;
                LoadData(thePagenumber);
                return false;
            }

            function LoadData(pagenumber) {
                ws_showProgressBar();
                ws_ajaxCall("/ServerConfig/GetAllInfoPathControls", { server: $('#webappdropdown').val(),
                    pagesize: $('#pagesizedropdown').val(),
                    pagenumber: pagenumber,
                    namefilter: $("#txtNameControl").val(),
                    descfilter: $("#txtDefinitionControl").val()
                }, CallBackSuccess, CallBackFailure, null);
                return false;
            }

            function CallBackFailure(xhr, status, error, callbackdata) {
                ws_hideProgressBar();
                if (xhr.responseText != null && xhr.responseText != undefined) {
                    alert("Status: " + xhr.Status + ", Error: " + xhr.responseText);
                }
            }

            function CallBackSuccess(data) {
                if (data.PageCount != undefined && data.RecordCount != undefined && data.Records != undefined) {
                    $('#table-controls > tbody tr').remove();
                    thePageCount = data.PageCount;
                    theRecordCount = data.RecordCount;
                    $.each(data.Records, function (k, v) {

                         {
                            var row = CreateRow(v);
                            $("#table-controls > tbody:last").append(row);
                        }
                    });
                }

                ws_hideProgressBar();
                return false;
            }

            function DeleteControl(id) {
                ws_showProgressBar();
                ws_ajaxCall("/ServerConfig/DeleteInfoPathControl", { server: $('#webappdropdown').val(),
                    id: id,
                    pagenumber: thePagenumber,
                    pagesize: $('#pagesizedropdown').val(),
                    namefilter: $("#txtNameControl").val(),
                    descfilter: $("#txtDefinitionControl").val()

                }, CallBackSuccess, CallBackFailure, null);

                return false;
            }

            function CreateRow(obj) {
                var markup = '    <tr id="' + obj.ID + '">' +
                                     '<td class="table-dropdown">' +
                                         '<span>' + obj.Name + '</span>' +
                                         '<div class="btn-group">' +
                                         '    <a class="btn btn-action dropdown-toggle" data-toggle="dropdown" href="#"></a>' +
                                        '     <ul class="dropdown-menu">' +
                                       '          <li><a href="form-control-edit.html?server=' + $('#webappdropdown').val() + '&name=' + obj.Name + '">Edit</a></li>' +
                                      '           <li><a href="#" onclick = "DeleteControl(' + obj.ID + ')">Delete</a></li>' +
                                     '        </ul>' +
                                    '     </div>' +
                                   '  </td>' +
                                  '   <td>' + $('<span/>').text(obj.MetaData.toString()).html() + '</td>' +
                                 '</tr> ';
                return markup;
            }
         </script>
    </body>
</html>
