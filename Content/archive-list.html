<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Winshuttle - Archive List</title>
        
        <link href="assets/css/kendo.common.min.css" rel="stylesheet">
        <link href="assets/css/kendo.default.min.css" rel="stylesheet">
        <link href="assets/css/kendo.dataviz.min.css" rel="stylesheet">
        <link href="assets/css/kendo.dataviz.default.min.css" rel="stylesheet">
        <link href="assets/css/winshuttle.css" rel="stylesheet">
        <link href="assets/css/ws-formitems.css" rel="stylesheet">
        <link href="assets/css/chosen.css" rel="stylesheet">
    </head>
    <body>
        <div id="workflow-header">
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span6">
                        <div class="workflow-brand">
                            <img src="assets/img/ws-logo-workflow.png" alt="Winshuttle">
	                        <div class="home-dropdown">
								<div class="btn-group">
								  <a class="btn btn-action dropdown-toggle" data-toggle="dropdown" href="#"></a>
								  <ul class="dropdown-menu">
								  	<div>
								  	<li class="dropdown-title">Logs &amp; Reporting</li>
								    <li><a href="#">Charts</a></li>
								    <li><a href="#">Excel Data Dump</a></li>
								    <li><a href="#">Logging</a></li>
								    <li><a href="#">Log File Viewer</a></li>
								  	<li class="dropdown-title">Processes</li>
								    <li><a href="#">Process Control</a></li>
								    <li><a href="#">Manage Background Jobs</a></li>
								    </div>
								    <div>
								  	<li class="dropdown-title">Server Administration</li>
								    <li><a href="#">Admin Commands</a></li>
								    <li><a href="#">Configure Options</a></li>
								    <li><a href="#">Scheduler</a></li>
								    <li><a href="#">Workflow Extensions</a></li>
								    <li><a href="#">Database Status</a></li>
								    <li><a href="#">Licenses</a></li>
								    </div>
								  </ul>
								</div>
							</div>
                        </div>
                    </div>

                    <div class="span6">
                        <ul class="display-inline-children pull-right">
                            <!--<li>
                                <a class="font-white" href="javascript:;">&#9664; Winshuttle Central</a>
                            </li>-->
                            <li>
                                <select class="input-medium" id="WFWebAppsDropDown">
                                </select>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="mainsi">
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span12">
                        <ul id="breadcrumbs">
                            <li><a href="#">Administration</a> &rsaquo;</li>
                            <li><a href="#">Scheduler</a></li>
                            <li class="related-links">
								<ul>
									<li class="related-label">Related:</li>
									<li class="link"><a href="#">Scheduler</a></li>
									<li class="link"><a href="#">Mark Inactive Processes</a></li>
									<li class="link"><a href="#">Purge Services</a></li>
									<li class="link"><a href="#">Archive Solution Definition</a></li>
								</ul>
							</li>
                        </ul>
                        <ul id="secnav">
                            <li class="active">
                                <h1>Purge Process Data</h1>
                                <p class="page-description">Page description goes here.  If no page description exists, delete this paragraph.  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span8">
                        
                        <div class="settings-info">
                            <form class="form-horizontal">
                                <fieldset>
                                    <div class="control-group">
                                        <label class="control-label">Source Site <span class="required">*</span></label>
                                        <div class="controls">
                                            <select class="input-max" id="sourceSiteDropDown">
                                                <option>site:3000</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Source List <span class="required">*</span></label>
                                        <div class="controls">
                                            <select class="input-max" id="sourceListDropDown">
                                                <option>Expense Report</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Archive</label>
                                        <div class="controls">
                                            <ul class="checkbox-group inline-list">
                                                <li>
                                                    <label>
                                                        <input class="js-archive-toggle-view-master-0" type="radio" name="TEMPNAME-logretention" id="archiveNowRadio" check-text="now" checked="checked">
                                                        <span>Now</span>
                                                    </label>
                                                </li>
                                                <li>
                                                    <label>
                                                        <input class="js-archive-toggle-view-master-1" type="radio" name="TEMPNAME-logretention" id="archiveScheduleRadio" check-text="schedule">
                                                        <span>Schedule</span>
                                                    </label>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    
                                    <div class="js-archive-toggle-view-slave-1 control-group js-initial-hide">
                                        <label class="control-label">Schedule <span class="required">*</span></label>
                                        <div class="controls">
                                            <select class="js-chosen-target input-mid" id="archiveScheduleDayDropDown">
                                                <option value="1">First Day of the month</option>
                                                <option value="100">Last Day of the month</option>
                                                <option value="2">2nd</option>
                                                <option value="3">3rd</option>
                                                <option value="4">4th</option>
                                                <option value="5">5th</option>
                                                <option value="6">6th</option>
                                                <option value="7">7th</option>
                                                <option value="8">8th</option>
                                                <option value="9">9th</option>
                                                <option value="10">10th</option>
                                                <option value="11">11th</option>
                                                <option value="12">12th</option>
                                                <option value="13">13th</option>
                                                <option value="14">14th</option>
                                                <option value="15">15th</option>
                                                <option value="16">16th</option>
                                                <option value="17">17th</option>
                                                <option value="18">18th</option>
                                                <option value="19">19th</option>
                                                <option value="20">20th</option>
                                                <option value="21">21st</option>
                                                <option value="22">22nd</option>
                                                <option value="23">23rd</option>
                                                <option value="24">24th</option>
                                                <option value="25">25th</option>
                                                <option value="26">26th</option>
                                                <option value="27">27th</option>
                                                <option value="28">28th</option>
                                                <option value="29">29th</option>
                                                <option value="30">30th</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="js-archive-toggle-view-slave-1 control-group js-initial-hide">
                                        <label class="control-label">Time <span class="required">*</span></label>
                                        <div class="controls ">
                                            <input type="text" id="archiveScheduleTimeDropDown" class="js-kendo-timepicker form-control input-small" placeholder="HH:mm">
                                        </div>
                                    </div>
                                    
                                    <div class="js-archive-toggle-view-slave-1 control-group js-initial-hide">
                                        <label class="control-label">User(s) to Notify </label>
                                        <div class="controls ">
                                            <input type="text" id="userToNotifyTextBox" class="form-control input-block-level" placeholder="user@winshuttle.com">
                                        </div>
                                    </div>
                                    
                                    <div class="form-actions">
                                        <button type="submit" id="btnSave" class="btn btn-primary"><span>Save</span></button>
                                        <button class="btn"><span>Cancel</span></button>
                                    </div>
                                    
                                </fieldset>
                            </form>
                        </div>
                        
                    </div><!-- /div .span8 -->
                </div><!-- /div .row-fluid -->
            </div><!-- /div .container-fluid -->
            
            </div><!-- /div #mainsi -->
        	<div id="footer" class="row-fluid">
                <div class="container-fluid">
                    <div class="row-fluid">
                        <div class="span8">
                            <div id="footer-links">
                                <ul>
                                    <li><a href="#">Help</a></li>
                                    <li><a href="#">About</a></li>
                                    <li><a href="#">Terms</a></li>
                                    <li><a href="#">Privacy Policy</a></li>
                                </ul>
                                <ul>
                                    <li>&copy; 2008-2011 Winshuttle, LLC</li>
                                    <li>Version 10.4</li>
                                    <li>Privacy Mode: Secure</li>
                                </ul>
                            </div>
                        </div>
                        <div class="span4">
                            <ul class="security-logo">
                                <li><img src="assets/img/security-te.png" alt="TRUSTe"/></li>
                                <li><img src="assets/img/security-sh.png" alt="Safe Harbor"/></li>
                                <li><img src="assets/img/security-soc.png" alt="SSAE 16 / ISAE 3402 Type II SOC 1"/></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script>
        if (!window.jQuery) {
            console.error("jQuery CDN is down.")
            document.write('<script src="assets/js/jquery.min.js"><\/script>');
        }
        </script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
        <script>
        if (!$.fn.modal) {
            console.error("Bootstrap CDN is down.")
            document.write('<script src="assets/js/bootstrap.min.js"><\/script>');
        }
        </script>
        <script src="assets/js/kendo.all.min.js"></script>
        <script src="assets/js/chosen.jquery.min.js"></script>
        <script src="assets/js/wslib_master.js"></script>
        <script src="assets/js/wsplugin_master.js"></script>
        <script src="assets/js/ws_global_initialization_administration.js"></script>
        <script src="assets/js/ws_common.js"></script>
        <script>
            $('.js-chosen-target').chosen({
                width: "210px",
                disable_search: true
            });
            
            wsLib_toggleViews("archive", 2, "radio", "no", 200);
            
            
            
            var ws_fillSite = function (url, target, callback) {

                ws_ajaxCall(url, null, function (data, callbackdata) {
                    $(target).find('option').remove();
                    var options = getOption(data);
                    $(target).append($(options));

                    // callback after this.
                    if (callback != null && callback != undefined) {
                        callback(data, callbackdata);
                    }
                }, null, null);

                function getOption(data) {
                    var option = '';

                    $.each(data, function (k, v) {
                        option += '<option value="' + v.URL + '">' + v.URL + '</option>';
                    });

                    return option;
                }
            }

            var ws_fillList = function (url, target, callback) {

                ws_ajaxCall(url, null, function (data, callbackdata) {
                    $(target).find('option').remove();
                    var defaultValue = '<option value=""></option>';
                    $(target).append($(defaultValue));
                    var options = getOption(data);
                    $(target).append($(options));

                    // callback after this.
                    if (callback != null && callback != undefined) {
                        callback(data, callbackdata);
                    }
                }, null, null);

                function getOption(data) {
                    var option = '';

                    $.each(data, function (k, v) {
                        option += '<option value="' + v.Name + '">' + v.Name + '</option>';
                    });

                    return option;
                }
            }

            var ws_FillSiteAndList = function () {
                var selectedWebApp = $('#WFWebAppsDropDown').val();
                ws_fillSite("/admin/GetAllSites?server=" + selectedWebApp, $('#sourceSiteDropDown'), function (data, callbackdata) {
                    var selectedSite = $('#sourceSiteDropDown').val();
                    ws_fillList("/admin/GetAllLists?site=" + selectedSite, $('#sourceListDropDown'), null);
                });
            }
            $(document).ready(function () {
                ws_initializeWebApp("/admin/GetAllWebApp", $('#WFWebAppsDropDown'), function (data, callbackdata) {
                    ws_FillSiteAndList();
                });
            });


            $("#WFWebAppsDropDown").change(function () {
                ws_FillSiteAndList();
            });

            $("#sourceSiteDropDown").change(function () {
                var selectedSite = $('#sourceSiteDropDown').val();
                ws_fillList("/admin/GetAllLists?site=" + selectedSite, $('#sourceListDropDown'), null);
            });

            function CallBackFunction(data, callbackdata) {
                alert(data);
            }

            $("#btnSave").click(function () {
                var strSite, strList, blnArchiveNow, strScheduleDay, strScheduleTime, strUserNotifyEmail, strScheduleType;

                //Getting Source details

                strSite = $("#sourceSiteDropDown").val();
                if (strSite.length == 0) {
                    return false;
                }

                strList = $("#sourceListDropDown").val();

                //Getting Schedule Details
                strScheduleType = $("input[name=TEMPNAME-logretention]:checked").attr('check-text');
                blnArchiveNow = $("#archiveNowRadio").prop('checked');
                if (blnArchiveNow == false) {
                    strScheduleDay = $("#archiveScheduleDayDropDown").val();
                    if (strScheduleDay.length == 0) {
                        return false;
                    }
                    strScheduleTime = $("#archiveScheduleTimeDropDown").val();
                    if (strScheduleTime.length == 0) {
                        return false;
                    }
                }
                strUserNotifyEmail = $("#userToNotifyTextBox").val();
                if (strUserNotifyEmail.length == 0) {
                    return false;
                }

                //Getting HostName
                var strHostName = $("#WFWebAppsDropDown").val();
                if (strHostName.length == 0) {
                    return false;
                }

                ws_ajaxCall('/Scheduler/CreateArchiveListServiceEntry',
                            {
                                sourceSite: strSite,
                                sourceList: strList,
                                isArchiveNow: blnArchiveNow,
                                scheduleType: strScheduleType,
                                scheduleDay: strScheduleDay,
                                scheduleTime: strScheduleTime,
                                usersToNotify: strUserNotifyEmail,
                                hostName: strHostName
                            },
                              CallBackFunction, null,
                              null);
                return false;
            });
        </script>
    </body>
</html>